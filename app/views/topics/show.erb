
<div class="show-all">
  <div class="show-main">
      <div class="topic-title"><%= @topic.title %></div>
    <% if @topic.images.present? %>
      <div class="show-photo">
        <% @topic.images.each do |image| %>
          <%= image_tag image.url, height:"150px", width:"auto" ,class:"topic-image" %>
        <% end %>
      </div>
    <% end %>
    <div class="show-topic-comments">
      <div class="show-topic">
        <div class="topic-category"><%= @topic.category.name %></div>
        <div class="topic-text"><%= @topic.text %></div>
        <div class="topic-bottom">
        <div class="topic-user">
          <% unless @topic.anonymous == true %>
            <%= image_tag @topic.user.image_url, class:"topic-icon" %>
            <div class="date">
              <%= time_ago_in_words(@topic.created_at) %>前<br>
              <%= @topic.user.nickname %>
            </div>
          <% else %>
            <div class="date">
              <%= time_ago_in_words(@topic.created_at) %>前<br>
              ID: <%= @topic.user.public_uid %>
            </div>
          <% end %>
        </div>
        </div>
      </div>
    </div>
    <div class="comment-main">
      <div class="comments">
        <% if @comments.present? %>
        <% @comments.each do |comments| %>
          <% if comments.type_id == 3 %>
            <div class="comment1">
              <% if comments.images.present? %>
                <div class="show-photo">
                  <% comments.images.each do |image| %>
                    <%= image_tag image.url, height:"100px", width:"auto" ,class:"topic-image" %>
                  <% end %>
                </div>
              <% end %>
              <%= comments.comment %><br>
              <div class="comment-user">
                <% unless comments.anonymous == true %>
                  <%= image_tag comments.user.image_url, class:"topic-icon" %>
                  <div class="date">
                    <%= time_ago_in_words(comments.created_at) %>前<br>
                    <%= comments.user.nickname %>
                  </div>
                <% else %>
                  <div class="date">
                    <%= time_ago_in_words(comments.created_at) %>前<br>
                    ID: <%= comments.user.public_uid %>
                  </div>
                <% end %>
              </div>
            </div>
          <% else %>
            <div class="comment2">
              <% if comments.images.present? %>
                <div class="show-photo">
                  <% comments.images.each do |image| %>
                    <%= image_tag image.url, height:"100px", width:"100px" ,class:"topic-image" %>
                  <% end %>
                </div>
              <% end %>
              <%= comments.comment %><br>
              <div class="comment-user">
                <% unless comments.anonymous == true %>
                  <%= image_tag comments.user.image_url, class:"topic-icon" %>
                  <div class="date">
                    <%= time_ago_in_words(comments.created_at) %>前<br>
                    <%= comments.user.nickname %>
                  </div>
                <% else %>
                  <div class="date">
                    <%= time_ago_in_words(comments.created_at) %>前<br>
                    ID: <%= comments.user.public_uid %>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        <% end %>
        <% else %>
        <div class="comment-none">
        この投稿にはまだコメントがありません。
        </div>
        <% end %>
      </div>
    </div>
    <div class="comment-form-main">
      <% if user_signed_in? %>
        <div class="comment-form">
          <%= form_with(model: [@topic,@comment],local: true) do |f| %>
            <%= render 'shared/error', model: f.object %>
            <%= f.file_field :images, multiple: true,id: :topic_imgs, class:"f-file" %>
            <p>4枚まで投稿可能</p>
            <%= f.collection_select(:type_id, Type.all, :id, :name, {},{class: "f-type form"}) %>
            <%= f.text_area :comment, placeholder: "コメントを入力", class:"f-comment-text form" %>
            <div class="checkbox-comment">
            <%= f.label :anonymous, "匿名表示にする" %>
            <%= f.check_box :anonymous ,{checked: true}, "true", "false" %>
            </div>
            <%= f.submit "コメントを投稿する", class:"f-submit" %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>